# SkipPreliminaryController テスト仕様

## 概要
事前相談スキップURLアクセス処理用コントローラー（SkipPreliminaryController）のテスト仕様です。
このコントローラーは、事前相談をスキップするための特殊なURLにアクセスした際の処理を担当します。

## テスト対象
- クラス: `App\Http\Controllers\Apply\SkipPreliminaryController`
- メソッド: `handle(Request $request, string $ulid)`

## テストケース

### 1. 無効なULIDが渡された場合のテスト
- **テスト名**: `無効なULIDが渡された場合はウェルカムページにエラーメッセージとともにリダイレクトされること`
- **条件**:
  - 無効なULIDがパラメータとして渡される
  - SkipPreliminaryServiceのvalidateTokenメソッドがnullを返す
- **期待する結果**:
  - ウェルカムページ（route('welcome')）にリダイレクトする
  - セッションにエラーメッセージが設定される

### 2. 有効なULIDでログイン済み事務局ユーザーの場合のテスト
- **テスト名**: `有効なULIDでログイン済み事務局ユーザーの場合は申出検索画面にリダイレクトされること`
- **条件**:
  - 有効なULIDがパラメータとして渡される
  - ユーザーはログイン済み（Auth::check() が true）
  - ユーザーは事務局ユーザー（role_id = 2）
- **期待する結果**:
  - 申出検索画面（route('apply.lists.search')）にリダイレクトする
  - セッションに情報メッセージが設定される

### 3. 有効なULIDでログイン済み一般ユーザーの場合のテスト
- **テスト名**: `有効なULIDでログイン済み一般ユーザーの場合は最低限必要な情報登録画面にリダイレクトされること`
- **条件**:
  - 有効なULIDがパラメータとして渡される
  - ユーザーはログイン済み（Auth::check() が true）
  - ユーザーは一般ユーザー（role_id = 1）
- **期待する結果**:
  - 最低限必要な情報登録画面（route('apply.minimum-info.create')）にリダイレクトする

### 4. 有効なULIDで未ログインの場合のテスト
- **テスト名**: `有効なULIDで未ログインの場合はログイン画面にリダイレクトされ意図したURLが設定されること`
- **条件**:
  - 有効なULIDがパラメータとして渡される
  - ユーザーは未ログイン（Auth::check() が false）
- **期待する結果**:
  - ログイン画面（route('login')）にリダイレクトする
  - セッションにintended URLとして最低限必要な情報登録画面のURLが設定される 